# esp32 透传 交互协议

## 1.协议格式
```c
typedef struct
{
    uint8_t head;
    uint16_t len;
    uint16_t inf
    uint8_t cmd;
    uint8_t * payload;
    uint8_t foot;
    uint8_t sum;
}

```
**说明**
|名称|说明|
|---|---|
|head|固定头，"L"|
|len|从head到sum|
|inf|保留|
|cmd|详见cmd说明|
|payload|负载内容|
|foot|固定尾，“N”|
|sum|和校验，从head到foot|

## 2.CMD说明

**基于“私有协议规范V0.0.1”**

支持如下命令：
|名称|define|cmd|说明|
|---|---|---|---|
|获取软件版本请求|CMD_VERSION_REQ|0||
|获取软件版本应答|CMD_VERSION_RESP|1||
|获取配置请求|CMD_GET_CONF_REQ|2||
|获取配置应答|CMD_GET_CONF_RESP|3||
|设置配置请求|CMD_SET_CONF_REQ|4||
|设置配置应答|CMD_SET_CONF_RESP|5||
|||||
|||||


## 3 CMD内容
### 3.1 获取软件版本请求 CMD_VERSION_REQ
**payload格式：**NULL
**payload内容：**
**应答（resp）：**CMD_VERSION_RESP

### 3.2 获取软件版本应答 CMD_VERSION_RESP
**payload格式：**V
**payload内容：**
```c
{
	uint32_t version;
}
version = VERSION_MAJOR * 256 * 256 | VERSION_MINOR * 256 | VERSION_LITE;

```
### 3.3 获取配置请求  CMD_GET_CONF_REQ
**payload格式：**NULL
**payload内容：**无
**Resp：**CMD_GET_CONF_RESP

### 3.4 获取配置应答 CMD_GET_CONF_RESP
**payload格式：**TLV
**payload内容：**
|T|L|V|
|---|---|---|
|0x00|1|workingmode|
|0x01|random|ssid|
|0x02|random|password|
|0x03|1|dhcp_flag|
|0x04|4|DNS|
|0x05|4|gateway|
|0x06|1|domainname flag|
|0x07|random|domain_name|
|0x08|4|target ip|
|0x09|2|target port|
|0x0a|4|local ip|
|0x0b|2|local port|
|0x0c|2|local conf port|
||||
||||
||||
||||
### 3.5 设置配置请求 CMD_SET_CONF_REQ
**payload格式：**NULL
**payload内容：**
|T|L|V|
|---|---|---|
|0x00|1|workingmode|
|0x01|random|ssid|
|0x02|random|password|
|0x03|1|dhcp_flag|
|0x04|4|DNS|
|0x05|4|gateway|
|0x06|1|domainname flag|
|0x07|random|domain_name|
|0x08|4|target ip|
|0x09|2|target port|
|0x0a|4|local ip|
|0x0b|2|local port|
|0x0c|2|local conf port|
||||
||||
||||
||||
**Resp：**CMD_GET_CONF_RESP
### 3.6 设置配置应答 CMD_SET_CONF_RESP
**payload格式：**V
**payload内容：**
```c
{
	uint8_t status;
}
```
* 0x00  > 成功
* 0x01 > 失败














